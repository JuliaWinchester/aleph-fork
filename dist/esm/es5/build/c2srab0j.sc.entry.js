var KeyDown,KeyPress,_this=this;import*as tslib_1 from"../polyfills/tslib.js";import{h}from"../aleph.core.js";import{a as DisplayMode,b as Orientation}from"./chunk-a3ddc7e5.js";!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.Spacebar=32]="Spacebar",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.PrintScrn=44]="PrintScrn",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Zero=48]="Zero",e[e.One=49]="One",e[e.Two=50]="Two",e[e.Three=51]="Three",e[e.Four=52]="Four",e[e.Five=53]="Five",e[e.Six=54]="Six",e[e.Seven=55]="Seven",e[e.Eight=56]="Eight",e[e.Nine=57]="Nine",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.Numpad0=96]="Numpad0",e[e.Numpad1=97]="Numpad1",e[e.Numpad2=98]="Numpad2",e[e.Numpad3=99]="Numpad3",e[e.Numpad4=100]="Numpad4",e[e.Numpad5=101]="Numpad5",e[e.Numpad6=102]="Numpad6",e[e.Numpad7=103]="Numpad7",e[e.Numpad8=104]="Numpad8",e[e.Numpad9=105]="Numpad9",e[e.Multiply=106]="Multiply",e[e.NumpadPlus=107]="NumpadPlus",e[e.NumpadMinus=109]="NumpadMinus",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.Semicolon=186]="Semicolon",e[e.Equals=187]="Equals",e[e.Comma=188]="Comma",e[e.LessThan=188]="LessThan",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.GreaterThan=190]="GreaterThan",e[e.ForwardSlash=191]="ForwardSlash",e[e.QuestionMark=191]="QuestionMark",e[e.GraveAccent=192]="GraveAccent",e[e.Tilde=192]="Tilde",e[e.OpenCurlyBracket=219]="OpenCurlyBracket",e[e.OpenSquareBracket=219]="OpenSquareBracket",e[e.BackSlash=220]="BackSlash",e[e.VerticalPipe=220]="VerticalPipe",e[e.CloseCurlyBracket=221]="CloseCurlyBracket",e[e.CloseSquareBracket=221]="CloseSquareBracket",e[e.Quote=222]="Quote",e[e.CommandFF=224]="CommandFF"}(KeyDown||(KeyDown={})),function(e){e[e.Backspace=8]="Backspace",e[e.Enter=13]="Enter",e[e.Spacebar=32]="Spacebar",e[e.Hash=35]="Hash",e[e.GraveAccent=39]="GraveAccent",e[e.DoubleQuote=34]="DoubleQuote",e[e.Asterisk=42]="Asterisk",e[e.Plus=43]="Plus",e[e.Comma=44]="Comma",e[e.Minus=45]="Minus",e[e.Period=46]="Period",e[e.ForwardSlash=47]="ForwardSlash",e[e.Zero=48]="Zero",e[e.One=49]="One",e[e.Two=50]="Two",e[e.Three=51]="Three",e[e.Four=52]="Four",e[e.Five=53]="Five",e[e.Six=54]="Six",e[e.Seven=55]="Seven",e[e.Eight=56]="Eight",e[e.Nine=57]="Nine",e[e.Colon=58]="Colon",e[e.Semicolon=59]="Semicolon",e[e.LessThan=60]="LessThan",e[e.Equals=61]="Equals",e[e.GreaterThan=62]="GreaterThan",e[e.QuestionMark=63]="QuestionMark",e[e.At=64]="At",e[e.OpenSquareBracket=91]="OpenSquareBracket",e[e.BackSlash=92]="BackSlash",e[e.CloseSquareBracket=93]="CloseSquareBracket",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.OpenCurlyBracket=123]="OpenCurlyBracket",e[e.VerticalPipe=124]="VerticalPipe",e[e.CloseCurlyBracket=125]="CloseCurlyBracket",e[e.Tilde=126]="Tilde"}(KeyPress||(KeyPress={}));var Constants=function(){};Constants.fontSizeSmall=.75,Constants.fontSizeMedium=1.5,Constants.fontSizeLarge=2.5,Constants.movedEventName="-moved",Constants.titleIdName="-title",Constants.controllerName="-controller",Constants.nodeSizeRatio=75,Constants.backboardSize=10,Constants.zoomFactor=2.5,Constants.minLoadingMS=500,Constants.topLayerRenderOrder=999,Constants.angleUnitsDecimalPlaces=3,Constants.edgeSize=.005,Constants.stackSpaceMultiplier={x:10,y:10,z:10},Constants.maxAnimationSteps=50,Constants.minFrameMS=15,Constants.minTimeForThrottle=5*Constants.minFrameMS,Constants.buttonColors={active:"#f50057",hover:"#f50057",up:"#00b0ff"},Constants.colorValues={red:"#f50057",blue:"#00b0ff",black:"#000000",white:"#ffffff",yellow:"#ffeb3b",green:"#76ff03",lightRed:"#f77777"},Constants.lightValues={ambientLightColor:13684944,ambientLightIntensity:1,directionalLight1Color:16777215,directionalLight1Intensity:.75,directionalLight2Color:10584,directionalLight2Intensity:.5},Constants.cameraValues={near:.05,far:1e4,fov:45,maxPolarAngle:165,rotateSpeed:.5,zoomSpeed:1,dampingFactor:.25,minDistance:0};var ThreeUtils=function(){function e(){}return e.isWebGL2Available=function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},e.enableOrbitControls=function(e,t){e.setAttribute("al-orbit-control","enabled: "+t)},e.waitOneFrame=function(e){window.setTimeout(function(){e()},Constants.minFrameMS)},e.objectToVector3=function(e){var t=new THREE.Vector3;return t.x=e.x,t.y=e.y,t.z=e.z,t},e.worldToScreen=function(e,t,n){var i=e.clone();return i.project(t),i.x=Math.round((i.x+1)*n.offsetWidth/2),i.y=Math.round((1-i.y)*n.offsetHeight/2),i.z=0,i},e.vector3ToString=function(e){return e.toArray().join(" ")},e.stringToVector3=function(e){var t=e.split(" "),n=new THREE.Vector3;return n.x=Number(t[0]),n.y=Number(t[1]),n.z=Number(t[2]),n},e.slerp=function(e,t,n){var i=n,r=e,s=t,o=r.angleTo(s);if(o){o=THREE.Math.clamp(o,-.99,.99);var a=Math.sin(1-i)*o,l=Math.sin(i*o),d=Math.sin(o),c=a/d,h=l/d,u=r.clone().multiplyScalar(c),p=s.clone().multiplyScalar(h);return u.add(p)}return null},e.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},e.getSlerpPath=function(t,n,i,r){for(var s=[],o=t.position.clone().addScalar(Number.EPSILON),a=t.target.clone().addScalar(Number.EPSILON),l=n.position.clone().addScalar(Number.EPSILON),d=n.target.clone().addScalar(Number.EPSILON),c=0;c<=Constants.maxAnimationSteps;c++){var h=this.easeInOutCubic(c/Constants.maxAnimationSteps);s.push({position:i?e.slerp(o.clone(),l.clone(),h):l,target:r?e.slerp(a.clone(),d.clone(),h):d})}return s},e}(),AMIUtils=function(){function e(){}return e._traceDataRay=function(e,t,n,i,r,s,o,a,l,d){for(var c=0,h=Math.floor,u=0|h(t),p=0|h(n),E=0|h(i),f=r>0?1:-1,_=s>0?1:-1,m=o>0?1:-1,v=Math.abs(1/r),g=Math.abs(1/s),y=Math.abs(1/o),b=v<1/0?v*(f>0?u+1-t:t-u):1/0,S=g<1/0?g*(_>0?p+1-n:n-p):1/0,T=y<1/0?y*(m>0?E+1-i:i-E):1/0,A=e.windowCenter-.5*e.windowWidth,w=-1;c<=a;){var C,O=new THREE.Vector3(u,p,E),D=AMI.CoreUtils.worldToData(e.stack.lps2IJK,O),P=AMI.CoreUtils.getPixelData(e.stack,D);if(C=null!==P&&P>A?1:0)return l&&(l.x=t+c*r,l.y=n+c*s,l.z=i+c*o),d&&(d.x=d.y=d.z=0,0===w&&(d.x=-f),1===w&&(d.y=-_),2===w&&(d.z=-m)),C;b<S?b<T?(u+=f,c=b,b+=v,w=0):(E+=m,c=T,T+=y,w=2):S<T?(p+=_,c=S,S+=g,w=1):(E+=m,c=T,T+=y,w=2)}return l&&(l.x=t+c*r,l.y=n+c*s,l.z=i+c*o),d&&(d.x=d.y=d.z=0),0},e.volumeRay=function(e,t,n,i,r,s){var o=+t.x,a=+t.y,l=+t.z,d=+n.x,c=+n.y,h=+n.z,u=Math.sqrt(d*d+c*c+h*h);if(0===u)throw new Error("Can't raycast along a zero vector");return this._traceDataRay(e,o,a,l,d/=u,c/=u,h/=u,i=void 0===i?64:+i,r,s)},e.toAframeSpace=function(e){return e.divide(ThreeUtils.objectToVector3(Constants.stackSpaceMultiplier))},e}(),EventUtils=function(){function e(){}return e.debounce=function(e,t){return t=t||100,function(){if(!e.debouncing){var n=Array.prototype.slice.apply(arguments);e.lastReturnVal=e.apply(this,n),e.debouncing=!0}return clearTimeout(e.debounceTimeout),e.debounceTimeout=setTimeout(function(){e.debouncing=!1},t),e.lastReturnVal}},e}(),GetUtils$$1=function(){function e(){}return e.addCssUnits=function(e){return this.cssUnits.some(function(t){return e.includes(t)})||(e+="px"),e},e.getFileExtension=function(e){return e.substring(e.lastIndexOf(".")+1)},e.getGeometryCenter=function(e){var t;return(t=e instanceof THREE.BufferGeometry?(new THREE.Geometry).fromBufferGeometry(e):e).computeBoundingSphere(),t.boundingSphere.center},e.getCameraStateFromMesh=function(e){var t,n,i;if(e){var r=e.geometry;return t=this.getGeometryCenter(r),i=Constants.zoomFactor*r.boundingSphere.radius/Math.tan(Constants.cameraValues.fov*Math.PI/180),(n=new THREE.Vector3).copy(t),n.z+=i,{target:t,position:n}}return null},e.getCameraPositionFromNode=function(e,t,n){if(!e)return null;var i=new THREE.Vector3;i.copy(ThreeUtils.stringToVector3(e.position));var r=i.clone().sub(n.clone()).normalize(),s=new THREE.Vector3;return s.copy(i),s.add(r.clone().multiplyScalar(t*Constants.zoomFactor)),s},e.getBoundingBox=function(e){return(new THREE.Box3).setFromObject(e)},e}();GetUtils$$1.cssUnits=["%","ch","cm","em","ex","in","mm","pc","pt","px","rem","vh","vmax","vmin","vw"];var AlGraphEvents=function(){};AlGraphEvents.SELECTED="al-graph-selected",AlGraphEvents.POINTER_OVER="al-graph-pointer-over",AlGraphEvents.POINTER_OUT="al-graph-pointer-out",AlGraphEvents.DRAGGED="al-graph-dragged",AlGraphEvents.POINTER_DOWN="al-graph-pointer-down",AlGraphEvents.POINTER_UP="al-graph-pointer-up";var AlGraphEntryType,MeshFileType,RayType,GraphUtils=function(){function e(){}return e.getEntryWithHighestId=function(e){return e.size?Math.max.apply(Math,Array.from(e).map(function(e){return Number(e[0].split("-")[1])})):-1},e.getNextId=function(e,t){return e+"-"+Number(this.getEntryWithHighestId(t)+1)},e}(),ShaderUtils=function(){function e(){}return e.getHaloMaterial=function(e,t,n,i,r){return void 0===e&&(e=.5),void 0===t&&(t=.5),void 0===n&&(n=.5),void 0===i&&(i=.1),void 0===r&&(r=.5),new THREE.ShaderMaterial({uniforms:{r:{value:e},g:{value:t},b:{value:n},a:{value:i},c:{value:r}},vertexShader:this.haloVertex,fragmentShader:this.haloFragment,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1})},e}();ShaderUtils.haloVertex="\n    varying vec3 vNormal;\n\n    void main()\n    {\n        vNormal = normalize( normalMatrix * normal );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n  ",ShaderUtils.haloFragment="\n    varying vec3 vNormal;\n    uniform float r;\n    uniform float g;\n    uniform float b;\n    uniform float a;\n    uniform float c;\n\n    void main()\n    {\n        float intensity = pow( c - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ), 4.0 );\n        gl_FragColor = vec4(r, g, b, a) * intensity;\n    }\n  ",function(e){e.NODE="node",e.EDGE="edge",e.ANGLE="angle"}(AlGraphEntryType||(AlGraphEntryType={})),function(e){e.GLTF="gltf",e.GLB="glb"}(MeshFileType||(MeshFileType={})),function(e){e.LOCK="LOCK",e.MESH="MESH"}(RayType||(RayType={})),AFRAME.registerComponent("al-angle",{schema:{selected:{type:"boolean"},edge0Pos:{type:"vec3"},edge1Pos:{type:"vec3"},position:{type:"vec3"},length:{type:"number"},radius:{type:"number"},angle:{type:"number"}},init:function(){this.tickFunction=AFRAME.utils.throttle(this.tickFunction,Constants.minFrameMS,this),this.bindMethods(),this.addEventListeners(),this.state={selected:!0,hovered:!1},this.createMesh()},bindMethods:function(){this.pointerDown=this.pointerDown.bind(this),this.pointerOver=this.pointerOver.bind(this),this.pointerOut=this.pointerOut.bind(this),this.createMesh=this.createMesh.bind(this)},addEventListeners:function(){this.el.addEventListener("mousedown",this.pointerDown,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected",this.pointerOver,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected-cleared",this.pointerOut,{capture:!1,once:!1,passive:!0})},removeEventListeners:function(){this.el.removeEventListener("mousedown",this.pointerDown),this.el.removeEventListener("raycaster-intersected",this.pointerOver),this.el.removeEventListener("raycaster-intersected-cleared",this.pointerOut)},pointerDown:function(e){this.el.sceneEl.emit(AlGraphEvents.SELECTED,{type:AlGraphEntryType.ANGLE,id:this.el.id},!0)},pointerOver:function(e){this.state.hovered=!0,this.el.sceneEl.emit(AlGraphEvents.POINTER_OVER,{id:this.el.id},!0)},pointerOut:function(e){this.state.hovered=!1,this.el.sceneEl.emit(AlGraphEvents.POINTER_OUT,{},!0)},createMesh:function(){var e=ThreeUtils.objectToVector3(this.data.edge0Pos),t=ThreeUtils.objectToVector3(this.data.edge1Pos),n=new THREE.Matrix4;n.lookAt(e,t,(new THREE.Object3D).up),n.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));var i=new THREE.CylinderGeometry(this.data.radius,this.data.radius,this.data.length,6,4),r=new THREE.MeshBasicMaterial,s=new THREE.Mesh(i,r);s.applyMatrix(n),s.position.copy(ThreeUtils.objectToVector3(this.data.position)),this.state.geometry=i,this.state.material=r,this.state.mesh=s;var o=new THREE.CylinderGeometry(this.data.radius,this.data.radius,this.data.length,6,4),a=ShaderUtils.getHaloMaterial(),l=new THREE.Mesh(o,a);this.state.outlineGeometry=o,this.state.outlineMaterialt=a,this.state.outlineMesh=l,s.add(l),this.el.setObject3D("mesh",s),this.el.object3D.renderOrder=Constants.topLayerRenderOrder-3},update:function(e){this.state.selected=this.data.selected,e&&e.angle!==this.data.angle&&this.createMesh()},tickFunction:function(){var e=this.el,t=this.state;t.material.color=t.hovered?new THREE.Color(Constants.buttonColors.hover):t.selected?new THREE.Color(Constants.buttonColors.active):new THREE.Color(Constants.buttonColors.up);var n=e.firstChild;n&&(n.object3D.visible=!!t.hovered)},tick:function(){this.tickFunction()},remove:function(){this.removeEventListeners(),this.el.removeObject3D("mesh")}}),AFRAME.registerComponent("al-bounding-box",{schema:{color:{type:"string",default:"#f50057"},scale:{type:"string"}},init:function(){this.bindMethods(),this.addEventListeners(),this.state={box:new THREE.Box3}},bindMethods:function(){},addEventListeners:function(){},removeEventListeners:function(){},update:function(){var e=this.el,t=this.state,n=ThreeUtils.stringToVector3(this.data.scale);t.box.setFromCenterAndSize(new THREE.Vector3(0,0,0),n);var i=new THREE.BoxGeometry(n.x,n.y,n.z),r=new THREE.MeshBasicMaterial({color:this.data.color,visible:!1}),s=new THREE.Mesh(i,r);e.setObject3D("mesh2",s),t.boundingBox=new THREE.Box3Helper(t.box,this.data.color),t.boundingBox.renderOrder=Constants.topLayerRenderOrder-5,e.setObject3D("mesh",t.boundingBox),t.geometry=i,t.material=r,t.mesh=s},remove:function(){this.removeEventListeners(),this.el.removeObject3D("mesh"),this.el.removeObject3D("mesh2")}}),AFRAME.registerComponent("al-edge",{schema:{selected:{type:"boolean"},node1:{type:"vec3"},node2:{type:"vec3"},length:{type:"number"},radius:{type:"number"},nodeScale:{type:"number"}},init:function(){this.tickFunction=AFRAME.utils.throttle(this.tickFunction,Constants.minFrameMS,this),this.bindMethods(),this.addEventListeners(),this.state={selected:!0,hovered:!1}},bindMethods:function(){this.pointerDown=this.pointerDown.bind(this),this.pointerOver=this.pointerOver.bind(this),this.pointerOut=this.pointerOut.bind(this),this.createMesh=this.createMesh.bind(this)},addEventListeners:function(){this.el.sceneEl.addEventListener("mousedown",this.pointerDown,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected",this.pointerOver,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected-cleared",this.pointerOut,{capture:!1,once:!1,passive:!0})},removeEventListeners:function(){this.el.sceneEl.removeEventListener("mousedown",this.pointerDown),this.el.removeEventListener("raycaster-intersected",this.pointerOver),this.el.removeEventListener("raycaster-intersected-cleared",this.pointerOut)},pointerDown:function(e){this.state.hovered&&this.el.sceneEl.emit(AlGraphEvents.SELECTED,{type:AlGraphEntryType.EDGE,id:this.el.id},!1)},pointerOver:function(e){this.state.hovered=!0,this.el.sceneEl.emit(AlGraphEvents.POINTER_OVER,{id:this.el.id},!1)},pointerOut:function(e){this.state.hovered=!1,this.el.sceneEl.emit(AlGraphEvents.POINTER_OUT,{},!1)},createMesh:function(){var e=ThreeUtils.objectToVector3(this.data.node1),t=ThreeUtils.objectToVector3(this.data.node2),n=new THREE.Matrix4;n.lookAt(e,t,(new THREE.Object3D).up),n.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));var i=new THREE.CylinderGeometry(this.data.radius,this.data.radius,this.data.length,6,4),r=new THREE.MeshBasicMaterial,s=new THREE.Mesh(i,r);s.applyMatrix(n),this.state.geometry=i,this.state.material=r,this.state.mesh=s;var o=new THREE.CylinderGeometry(this.data.radius,this.data.radius,this.data.length-2*this.data.nodeScale,6,4),a=ShaderUtils.getHaloMaterial(),l=new THREE.Mesh(o,a);this.state.outlineGeometry=o,this.state.outlineMaterialt=a,this.state.outlineMesh=l,s.add(l),this.el.setObject3D("mesh",s),this.el.object3D.renderOrder=Constants.topLayerRenderOrder-2},update:function(e){this.state.selected=this.data.selected,!e||e.radius===this.data.radius&&e.length===this.data.length||this.createMesh()},tickFunction:function(){var e=this.el,t=this.state;t.material.color=t.hovered?new THREE.Color(Constants.buttonColors.hover):t.selected?new THREE.Color(Constants.buttonColors.active):new THREE.Color(Constants.buttonColors.up);var n=e.firstChild;n&&(n.object3D.visible=!!t.hovered)},tick:function(){this.tickFunction()},remove:function(){this.removeEventListeners(),this.el.removeObject3D("mesh")}}),AFRAME.registerComponent("al-fixed-to-orbit-camera",{schema:{distanceFromTarget:{type:"number",default:.1},target:{type:"vec3"}},init:function(){if(this.tickFunction=AFRAME.utils.throttle(this.tickFunction,Constants.minFrameMS/2,this),this.data.target){var e=ThreeUtils.objectToVector3(this.data.target);this.state={distanceFromTarget:this.data.distanceFromTarget,target:e}}else this.state={distanceFromTarget:this.data.distanceFromTarget,target:new THREE.Vector3(0,0,0)};this.bindMethods(),this.addEventListeners()},bindMethods:function(){},addEventListeners:function(){},removeEventListeners:function(){},update:function(){var e=ThreeUtils.objectToVector3(this.data.target);this.state={distanceFromTarget:this.data.distanceFromTarget,target:e}},tickFunction:function(){var e=this.el,t=this.state,n=e.sceneEl.camera.position,i=t.target.clone().sub(n.clone()).normalize();e.object3D.position.copy(i.multiplyScalar(t.distanceFromTarget)),e.object3D.lookAt(n)},tick:function(){this.tickFunction()},remove:function(){this.removeEventListeners()}}),AFRAME.registerComponent("al-gltf-model",{schema:{src:{type:"model",default:""},dracoDecoderPath:{type:"string",default:""}},init:function(){this.bindMethods(),this.addEventListeners(),this.model=null,this.loader=new THREE.GLTFLoader,THREE.DRACOLoader.setDecoderPath(this.data.dracoDecoderPath),this.loader.setDRACOLoader(new THREE.DRACOLoader)},bindMethods:function(){},addEventListeners:function(){},removeEventListeners:function(){},update:function(e){var t=this,n=this.el,i=this.data.src;e&&e.src!==i&&(this.remove(),this.loader.load(i,function(e){t.model=e.scene||e.scenes[0],t.model.animations=e.animations,n.setObject3D("mesh",t.model),n.sceneEl.emit(AlGltfModelEvents.LOADED,{format:"gltf",model:t.model},!1)},void 0,function(e){console.warn(e&&e.message?e.message:"Failed to load glTF model"),n.sceneEl.emit(AlGltfModelEvents.ERROR,{format:"gltf",src:i},!1)}))},remove:function(){this.model&&(this.removeEventListeners(),this.el.removeObject3D("mesh"))}});var AlGltfModelEvents=function(){};AlGltfModelEvents.LOADED="al-model-loaded",AlGltfModelEvents.ERROR="al-model-error",AFRAME.registerComponent("al-look-to-camera",{schema:{},init:function(){this.bindMethods(),this.addEventListeners(),this.tickFunction=AFRAME.utils.throttle(this.tickFunction,Constants.minFrameMS,this)},bindMethods:function(){},addEventListeners:function(){},removeEventListeners:function(){},tickFunction:function(){this.el.object3D.lookAt(this.el.sceneEl.camera.position)},tick:function(){this.tickFunction()},remove:function(){this.removeEventListeners()}}),AFRAME.registerComponent("al-node",{schema:{scale:{type:"number",default:1},selected:{type:"boolean"},graphEnabled:{type:"boolean"}},init:function(){this.tickFunction=AFRAME.utils.throttle(this.tickFunction,Constants.minFrameMS,this),this.bindMethods(),this.addEventListeners();var e=this.data,t=this.el,n=t.sceneEl.camera.el.object3DMap.camera,i=new THREE.SphereGeometry(e.scale,16,16),r=new THREE.MeshBasicMaterial,s=new THREE.Mesh(i,r),o=new THREE.SphereGeometry(e.scale,16,16),a=ShaderUtils.getHaloMaterial(),l=new THREE.Mesh(o,a);s.add(l),t.setObject3D("mesh",s),t.object3D.renderOrder=Constants.topLayerRenderOrder-1,this.state={selected:!0,hovered:!1,geometry:i,material:r,mesh:s,outlineGeometry:o,outlineMaterial:a,outlineMesh:l,camera:n,dragging:!1}},bindMethods:function(){this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerOver=this.pointerOver.bind(this),this.pointerOut=this.pointerOut.bind(this)},addEventListeners:function(){this.el.sceneEl.addEventListener("mousedown",this.pointerDown,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("mouseup",this.pointerUp,{capture:!1,once:!1,passive:!0}),this.el.sceneEl.addEventListener("mouseup",this.pointerUp,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected",this.pointerOver,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected-cleared",this.pointerOut,{capture:!1,once:!1,passive:!0})},removeEventListeners:function(){this.el.sceneEl.removeEventListener("mousedown",this.pointerDown),this.el.sceneEl.removeEventListener("mouseup",this.pointerUp),this.el.removeEventListener("mouseup",this.pointerUp),this.el.removeEventListener("raycaster-intersected",this.pointerOver),this.el.removeEventListener("raycaster-intersected-cleared",this.pointerOut)},pointerDown:function(e){this.state.hovered&&(this.el.sceneEl.emit(AlGraphEvents.SELECTED,{type:AlGraphEntryType.NODE,id:this.el.id},!0),this.data.graphEnabled&&(this.state.mouseDown=!0,this.el.sceneEl.emit(AlGraphEvents.POINTER_DOWN,{},!0)))},pointerUp:function(e){var t=this.state;this.data.graphEnabled&&(t.dragging=!1,t.mouseDown=!1,this.el.sceneEl.emit(AlGraphEvents.POINTER_UP,{},!0))},pointerOver:function(e){this.state.hovered=!0,this.el.sceneEl.emit(AlGraphEvents.POINTER_OVER,{id:this.el.id},!0)},pointerOut:function(e){var t=this.state;t.hovered=!1,t.mouseDown&&t.selected&&(t.dragging=!0),this.el.sceneEl.emit(AlGraphEvents.POINTER_OUT,{},!0)},update:function(){this.state.selected=this.data.selected},tickFunction:function(){var e=this.el,t=this.state;this.data.graphEnabled&&t.dragging&&this.el.sceneEl.emit(AlGraphEvents.DRAGGED,{id:this.el.id},!0),t.material.color=t.hovered||t.dragging?new THREE.Color(Constants.buttonColors.hover):t.selected?new THREE.Color(Constants.buttonColors.active):new THREE.Color(Constants.buttonColors.up);var n=e.firstChild;n&&(n.object3D.visible=!(!t.hovered&&!t.dragging))},tick:function(){this.tickFunction()},remove:function(){this.removeEventListeners(),this.el.removeObject3D("mesh")}}),AFRAME.registerComponent("al-node-spawner",{schema:{graphEnabled:{type:"boolean"}},init:function(){this.bindMethods(),this.addEventListeners(),this.state={left:!1,intersecting:!1}},bindMethods:function(){this.canvasMouseDown=this.canvasMouseDown.bind(this),this.pointerOver=this.pointerOver.bind(this),this.pointerOut=this.pointerOut.bind(this),this.elClick=this.elClick.bind(this),this.canvasMouseUp=this.canvasMouseUp.bind(this),this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this)},addEventListeners:function(){this.el.sceneEl.canvas.addEventListener("mousedown",this.canvasMouseDown,{capture:!1,once:!1,passive:!0}),this.el.sceneEl.canvas.addEventListener("mouseup",this.canvasMouseUp,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected",this.pointerOver,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("raycaster-intersected-cleared",this.pointerOut,!1),this.el.addEventListener("click",this.elClick,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("mousedown",this.pointerDown,{capture:!1,once:!1,passive:!0}),this.el.addEventListener("mouseup",this.pointerUp,{capture:!1,once:!1,passive:!0})},removeEventListeners:function(){this.el.sceneEl.canvas.removeEventListener("mousedown",this.canvasMouseDown),this.el.sceneEl.canvas.removeEventListener("mouseup",this.canvasMouseUp),this.el.removeEventListener("raycaster-intersected",this.pointerOver),this.el.removeEventListener("raycaster-intersected-cleared",this.pointerOut),this.el.removeEventListener("click",this.elClick),this.el.removeEventListener("mousedown",this.pointerDown),this.el.removeEventListener("mouseup",this.pointerUp)},canvasMouseDown:function(e){this.state.left=0===e.button},canvasMouseUp:function(e){var t=this;ThreeUtils.waitOneFrame(function(){t.state.left=!1})},pointerOver:function(e){this.state.intersecting=!0,this.el.sceneEl.emit(AlNodeSpawnerEvents.VALID_TARGET,{valid:!0},!1)},pointerOut:function(e){this.state.intersecting=!1,this.el.sceneEl.emit(AlNodeSpawnerEvents.VALID_TARGET,{valid:!1},!1)},pointerDown:function(e){this.data.graphEnabled&&this.el.sceneEl.emit(AlGraphEvents.POINTER_DOWN,{},!1)},pointerUp:function(e){this.data.graphEnabled&&this.el.sceneEl.emit(AlGraphEvents.POINTER_UP,{},!1)},elClick:function(e){this.state.left&&this.data.graphEnabled&&this.el.sceneEl.emit(AlNodeSpawnerEvents.ADD_NODE,{aframeEvent:e},!1)},remove:function(){this.removeEventListeners()}});var AlNodeSpawnerEvents=function(){};AlNodeSpawnerEvents.VALID_TARGET="al-valid-target",AlNodeSpawnerEvents.ADD_NODE="al-add-node",AFRAME.registerComponent("al-orbit-control",{dependencies:["camera"],schema:{animating:{type:"boolean",default:!1},autoRotate:{type:"boolean"},autoRotateSpeed:{default:2},controlPosition:{type:"vec3"},controlTarget:{type:"vec3"},dampingFactor:{default:.1},enabled:{default:!0},enableDamping:{default:!0},enableKeys:{default:!0},enablePan:{default:!0},enableRotate:{default:!0},enableZoom:{default:!0},keyPanSpeed:{default:7},maxAzimuthAngle:{type:"number",default:1/0},maxDistance:{default:8e3},maxPolarAngle:{default:88},minAzimuthAngle:{type:"number",default:-1/0},minDistance:{default:1},minPolarAngle:{default:0},rotateSpeed:{default:.05},screenSpacePanning:{default:!1},zoomSpeed:{type:"number",default:.5}},bindMethods:function(){this.mouseDown=this.mouseDown.bind(this),this.mouseMove=this.mouseMove.bind(this),this.mouseUp=this.mouseUp.bind(this),this.canvasWheel=this.canvasWheel.bind(this),this.getCameraState=this.getCameraState.bind(this),this.handleAnimationCache=this.handleAnimationCache.bind(this),this.onWheel=this.onWheel.bind(this)},addListeners:function(){window.addEventListener("mouseup",this.mouseUp,{capture:!1,once:!1,passive:!0}),window.addEventListener("mousemove",this.mouseMove,{capture:!1,once:!1,passive:!0}),this.el.sceneEl.canvas.addEventListener("mousedown",this.mouseDown,{capture:!1,once:!1,passive:!0}),this.el.sceneEl.canvas.addEventListener("wheel",this.canvasWheel,{capture:!1,once:!1,passive:!0}),this.el.sceneEl.addEventListener(AlOrbitControlEvents.ANIMATION_STARTED,this.handleAnimationCache,!1)},removeListeners:function(){window.removeEventListener("mouseup",this.mouseUp),window.removeEventListener("mousemove",this.mouseMove),this.el.sceneEl.canvas.removeEventListener("mousedown",this.mouseDown),this.el.sceneEl.canvas.removeEventListener("wheel",this.canvasWheel),this.el.sceneEl.removeEventListener(AlOrbitControlEvents.ANIMATION_STARTED,this.handleAnimationCache,!1)},handleAnimationCache:function(e){this.state.animationCache=e.detail.slerpPath},mouseUp:function(e){this.state.mouseDown=!1,document.body.style.cursor="grab",this.state.controls.enabled&&this.el.sceneEl.emit(AlOrbitControlEvents.INTERACTION_FINISHED,{cameraState:this.getCameraState()},!1)},mouseDown:function(e){this.state.mouseDown=!0,document.body.style.cursor="grabbing"},mouseMove:function(e){this.state.mouseDown&&this.el.sceneEl.emit(AlOrbitControlEvents.INTERACTION,{cameraState:this.getCameraState()},!1)},onWheel:function(){var e=this,t=this.state;t.wheelMarker=!1,t.wheelCounter2=t.wheelCounter1,setTimeout(function(){t.wheelCounter2===t.wheelCounter1?(t.wheelMarker=!0,t.wheelCounter1=0,t.wheelCounter2=0,e.el.sceneEl.emit(AlOrbitControlEvents.INTERACTION_FINISHED,{cameraState:e.getCameraState()},!1)):e.onWheel()},t.wheelInterval)},canvasWheel:function(e){var t=this.state;t.wheelCounter1+=1,t.wheelMarker&&this.onWheel(),this.el.sceneEl.emit(AlOrbitControlEvents.INTERACTION,{cameraState:this.getCameraState()},!1)},init:function(){var e=this,t=this.el,n=this.data;document.body.style.cursor="grab",this.tickFunction=AFRAME.utils.throttle(this.tickFunction,Constants.minFrameMS,this);var i=new THREE.OrbitControls(t.getObject3D("camera"),t.sceneEl.renderer.domElement),r=ThreeUtils.objectToVector3(n.controlPosition),s=ThreeUtils.objectToVector3(n.controlTarget);i.object.position.copy(r),t.getObject3D("camera").position.copy(r),i.target.copy(s),this.state={animationCache:[],controls:i,mouseDown:!1,wheelCounter1:0,wheelCounter2:void 0,wheelInterval:50,wheelMarker:!0},this.bindMethods(),this.addListeners(),ThreeUtils.waitOneFrame(function(){e.el.sceneEl.emit(AlOrbitControlEvents.INTERACTION,{cameraState:e.getCameraState()},!1)})},getCameraState:function(){return{position:this.state.controls.object.position,target:this.state.controls.target}},update:function(e){var t=this.state.controls,n=this.data;t.target=ThreeUtils.objectToVector3(n.controlTarget),t.autoRotate=n.autoRotate,t.autoRotateSpeed=n.autoRotateSpeed,t.dampingFactor=n.dampingFactor,t.enabled=n.enabled,t.enableDamping=n.enableDamping,t.enableKeys=n.enableKeys,t.enablePan=n.enablePan,t.enableRotate=n.enableRotate,t.enableZoom=n.enableZoom,t.keyPanSpeed=n.keyPanSpeed,t.maxPolarAngle=THREE.Math.degToRad(n.maxPolarAngle),t.maxAzimuthAngle=THREE.Math.degToRad(n.maxAzimuthAngle),t.maxDistance=n.maxDistance,t.minDistance=n.minDistance,t.minPolarAngle=THREE.Math.degToRad(n.minPolarAngle),t.minAzimuthAngle=THREE.Math.degToRad(n.minAzimuthAngle),t.rotateSpeed=n.rotateSpeed,t.screenSpacePanning=n.screenSpacePanning,t.zoomSpeed=n.zoomSpeed,this.el.getObject3D("camera").position.copy(ThreeUtils.objectToVector3(n.controlPosition))},tickFunction:function(){var e=this.state.controls;if(e.enabled){if(this.data.animating){var t=this.state.animationCache.shift();t&&t.position&&t.target&&(e.object.position.copy(t.position),this.el.getObject3D("camera").position.copy(t.position),e.target.copy(t.target)),0===this.state.animationCache.length&&this.el.sceneEl.emit(AlOrbitControlEvents.ANIMATION_FINISHED,{},!1)}e.enabled&&(e.enableDamping||e.autoRotate)&&e.update()}},tick:function(){this.tickFunction()},remove:function(){this.removeListeners();var e=this.state;e.controls.dispose(),e=null}});var AlOrbitControlEvents=function(){};AlOrbitControlEvents.INTERACTION="al-orbit-interaction",AlOrbitControlEvents.INTERACTION_FINISHED="al-orbit-controls-interaction-finished",AlOrbitControlEvents.ANIMATION_STARTED="al-orbit-controls-animation-started",AlOrbitControlEvents.ANIMATION_FINISHED="al-orbit-controls-animation-finished",AFRAME.registerComponent("al-render-order",{schema:{order:{type:"number",default:Constants.topLayerRenderOrder}},init:function(){var e=this;this.bindMethods(),this.addEventListeners(),Object.keys(this.el.object3DMap).forEach(function(t){e.el.object3DMap[t].renderOrder=e.data.order})},bindMethods:function(){},addEventListeners:function(){},removeEventListeners:function(){},update:function(){var e=this;Object.keys(this.el.object3DMap).forEach(function(t){e.el.object3DMap[t].renderOrder=e.data.order})},remove:function(){this.removeEventListeners()}}),AFRAME.registerComponent("al-render-overlaid",{schema:{},init:function(e){this.bindMethods(),this.addEventListeners(),this.setDepth(this.el.object3DMap.mesh),this.setDepth(this.el.object3DMap.text)},bindMethods:function(){},addEventListeners:function(){},removeEventListeners:function(){},setDepth:function(e){e&&(e.renderOrder=Constants.topLayerRenderOrder,e.material&&(e.material.depthTest=!1))},remove:function(){this.removeEventListeners()}});var VolumetricLoader=function(){function e(){}return e.prototype.load=function(e,t){var n=this;return new Promise(function(i,r){var s=new XMLHttpRequest;s.open("GET",e,!0),s.onload=function(){var e=JSON.parse(s.responseText);e=n._mapfiles(e.baseurl,e.series);var o=new AMI.VolumeLoader(t);o.load(e).then(function(){var e=o.data[0].mergeSeries(o.data)[0].stack[0];o.free(),i(e)}).catch(function(e){console.log("Volume load error"),r(e)})},s.onerror=function(e){r(e)},s.send()})},e.prototype._mapfiles=function(e,t){return t.map(function(t){return e.endsWith("/")||(e+="/"),""+e+t})},e}();AFRAME.registerComponent("al-volume",{schema:{displayMode:{type:"string"},isWebGl2:{type:"boolean"},slicesIndex:{type:"number"},slicesOrientation:{type:"string"},slicesWindowCenter:{type:"number"},slicesWindowWidth:{type:"number"},src:{type:"string"},srcLoaded:{type:"boolean"},volumeSteps:{type:"number"},volumeWindowCenter:{type:"number"},volumeWindowWidth:{type:"number"}},init:function(){this.tickFunction=AFRAME.utils.throttle(this.tickFunction,Constants.minFrameMS,this),this.loader=new VolumetricLoader,this.state={bufferScene:new THREE.Scene,bufferSceneTextureHeight:this.el.sceneEl.canvas.clientHeight,bufferSceneTextureWidth:this.el.sceneEl.canvas.clientWidth},this.bindMethods(),this.addEventListeners(),this.createBufferTexture(),this.debouncedRenderBufferScene=EventUtils.debounce(this.renderBufferScene,Constants.minFrameMS).bind(this)},bindMethods:function(){this.addEventListeners=this.addEventListeners.bind(this),this.createVolumePlane=this.createVolumePlane.bind(this),this.handleStack=this.handleStack.bind(this),this.onInteraction=this.onInteraction.bind(this),this.onInteractionFinished=this.onInteractionFinished.bind(this),this.removeEventListeners=this.removeEventListeners.bind(this),this.renderBufferScene=this.renderBufferScene.bind(this),this.rendererResize=this.rendererResize.bind(this),this.createBufferTexture=this.createBufferTexture.bind(this)},addEventListeners:function(){this.el.sceneEl.addEventListener("rendererresize",this.rendererResize,!1),this.el.sceneEl.addEventListener(AlOrbitControlEvents.INTERACTION,this.onInteraction,!1),this.el.sceneEl.addEventListener(AlOrbitControlEvents.INTERACTION_FINISHED,this.onInteractionFinished,!1)},removeEventListeners:function(){this.el.sceneEl.removeEventListener("rendererresize",this.rendererResize),this.el.sceneEl.removeEventListener(AlOrbitControlEvents.INTERACTION,this.onInteraction),this.el.sceneEl.removeEventListener(AlOrbitControlEvents.INTERACTION_FINISHED,this.onInteractionFinished)},createBufferTexture:function(){this.state.bufferSceneTexture=new THREE.WebGLRenderTarget(this.state.bufferSceneTextureWidth,this.state.bufferSceneTextureHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter}),this.el.sceneEl.object3D.background=this.state.bufferSceneTexture.texture},onInteraction:function(e){this.state.stackhelper&&(this.state.stackhelper.steps=2,this.renderBufferScene())},onInteractionFinished:function(e){this.state.stackhelper&&(this.state.stackhelper.steps=this.data.volumeSteps,this.debouncedRenderBufferScene())},createVolumePlane:function(){var e=this.el.sceneEl.querySelector("#target-entity");if(e){var t=this.state,n=t.stackhelper.mesh.geometry.clone();n.computeBoundingBox(),n.computeBoundingSphere();var i=e.object3D.position.clone().add(GetUtils$$1.getGeometryCenter(n)),r=Math.max(this.state.stackhelper.stack.dimensionsIJK.x,Math.max(this.state.stackhelper.stack.dimensionsIJK.y,this.state.stackhelper.stack.dimensionsIJK.z)),s=new THREE.PlaneGeometry(r,r);t.bufferScenePlaneGeometry=s;var o=new THREE.MeshBasicMaterial({visible:!1});t.bufferScenePlaneMaterial=o;var a=new THREE.Mesh(s,o);a.position.copy(i),a.renderOrder=Constants.topLayerRenderOrder-4,t.bufferScenePlaneMesh=a,this.el.setObject3D("mesh",a)}},rendererResize:function(){var e=this.state;(e.bufferSceneTextureWidth!==this.el.sceneEl.canvas.clientWidth||e.bufferSceneTextureHeight!==this.el.sceneEl.canvas.clientHeight)&&this.data.displayMode===DisplayMode.VOLUME&&(e.bufferSceneTextureWidth=this.el.sceneEl.canvas.clientWidth,e.bufferSceneTextureHeight=this.el.sceneEl.canvas.clientHeight,this.createBufferTexture(),this.renderBufferScene())},renderBufferScene:function(){this.data.displayMode===DisplayMode.VOLUME&&this.el.sceneEl.renderer.render(this.state.bufferScene,this.el.sceneEl.camera,this.state.bufferSceneTexture)},handleStack:function(e){var t=this.state,n=this.el;switch(t.stack=e,this.data.displayMode){case DisplayMode.SLICES:t.stackhelper=new AMI.StackHelper(t.stack),t.stackhelper.bbox.visible=!1,t.stackhelper.border.color=Constants.colorValues.blue;break;case DisplayMode.VOLUME:var i=n.sceneEl.parentEl.querySelector("#lut-canvases");t.lutHelper=new AMI.LutHelper(i),t.lutHelper.luts=AMI.LutHelper.presetLuts(),t.lutHelper.lutsO=AMI.LutHelper.presetLutsO(),t.stackhelper=new AMI.VolumeRenderHelper(t.stack),t.stackhelper.textureLUT=t.lutHelper.texture}n.object3DMap.mesh&&n.removeObject3D("mesh"),this.data.displayMode===DisplayMode.SLICES?n.setObject3D("mesh",this.state.stackhelper):(this.state.bufferScene.children.length&&this.state.bufferScene.remove(this.state.bufferScene.children[0]),this.state.bufferScene.add(this.state.stackhelper),this.createVolumePlane()),n.sceneEl.emit(AlVolumeEvents.LOADED,t.stackhelper,!1)},update:function(e){var t=this,n=this.state;this.data.src&&(e&&e.src!==this.data.src?this.loader.load(this.data.src,this.el).then(function(e){t.handleStack(e)}):e&&e.displayMode!==this.data.displayMode&&n.stack&&(this.removeEventListeners(),this.handleStack(n.stack),this.addEventListeners(),this.data.displayMode===DisplayMode.VOLUME?(this.createBufferTexture(),setTimeout(function(){t.renderBufferScene()},250)):this.el.sceneEl.object3D.background=null))},tickFunction:function(){if(this.state.stackhelper)switch(this.data.displayMode){case DisplayMode.SLICES:this.el.setObject3D("mesh",this.state.stackhelper);break;case DisplayMode.VOLUME:this.state.bufferScenePlaneMesh.lookAt(this.el.sceneEl.camera.position)}},tick:function(){this.tickFunction()},remove:function(){this.el.removeObject3D("mesh"),this.removeEventListeners(),this.el.sceneEl.object3D.background=null,this.state.bufferScenePlaneMesh&&this.state.bufferScenePlaneMesh.remove(),this.state.bufferScenePlaneMaterial&&this.state.bufferScenePlaneMaterial.dispose(),this.state.bufferScenePlaneGeometry&&this.state.bufferScenePlaneGeometry.dispose()}});var TypeKeys,AlVolumeEvents=function(){};AlVolumeEvents.LOADED="al-volume-loaded",AlVolumeEvents.ERROR="al-volume-error",AlVolumeEvents.RENDER_LOW="al-volume-render-low",AlVolumeEvents.RENDER_FULL="al-volume-render-full",function(e){e.NULL="NULL",e.ERROR="ERROR",e.APP_CLEAR_ANGLES="APP_LOAD_ANGLES",e.APP_CLEAR_EDGES="APP_LOAD_EDGES",e.APP_CLEAR_NODES="APP_LOAD_NODES",e.APP_DELETE_ANGLE="APP_DELETE_ANGLE",e.APP_DELETE_EDGE="APP_DELETE_EDGE",e.APP_DELETE_NODE="APP_DELETE_NODE",e.APP_SELECT_ANGLE="APP_SELECT_ANGLE",e.APP_SELECT_EDGE="APP_SELECT_EDGE",e.APP_SELECT_NODE="APP_SELECT_NODE",e.APP_SET_ANGLE="APP_SET_ANGLE",e.APP_SET_BOUNDINGBOX_VISIBLE="APP_SET_BOUNDINGBOX_VISIBLE",e.APP_SET_CAMERA="APP_SET_CAMERA",e.APP_SET_CONTROLS_ENABLED="APP_SET_CONTROLS_ENABLED",e.APP_SET_DISPLAY_MODE="APP_SET_DISPLAY_MODE",e.APP_SET_EDGE="APP_SET_EDGE",e.APP_SET_NODE="APP_SET_NODE",e.APP_SET_NODES_ENABLED="APP_SET_NODES_ENABLED",e.APP_SET_ORIENTATION="APP_SET_ORIENTATION",e.APP_SET_SLICES_INDEX="APP_SET_SLICES_INDEX",e.APP_SET_SLICES_WINDOW_CENTER="APP_SET_SLICES_WINDOW_CENTER",e.APP_SET_SLICES_WINDOW_WIDTH="APP_SET_SLICES_WINDOW_WIDTH",e.APP_SET_SRC="APP_SET_SRC",e.APP_SET_SRC_LOADED="APP_SET_SRC_LOADED",e.APP_SET_VOLUME_STEPS="APP_SET_VOLUME_STEPS",e.APP_SET_VOLUME_WINDOW_CENTER="APP_SET_VOLUME_WINDOW_CENTER",e.APP_SET_VOLUME_WINDOW_WIDTH="APP_SET_VOLUME_WINDOW_WIDTH"}(TypeKeys||(TypeKeys={}));var root,appSetSrc=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_SRC,payload:e})]})})}},appSetSrcLoaded=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_SRC_LOADED,payload:e})]})})}},appSetNode=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_NODE,payload:e})]})})}},appDeleteNode=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_DELETE_NODE,payload:e})]})})}},appSelectNode=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SELECT_NODE,payload:e})]})})}},appClearNodes=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_CLEAR_NODES,payload:e})]})})}},appSetEdge=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_EDGE,payload:e})]})})}},appDeleteEdge=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_DELETE_EDGE,payload:e})]})})}},appSelectEdge=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SELECT_EDGE,payload:e})]})})}},appClearEdges=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_CLEAR_EDGES,payload:e})]})})}},appSetAngle=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_ANGLE,payload:e})]})})}},appDeleteAngle=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_DELETE_ANGLE,payload:e})]})})}},appSelectAngle=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SELECT_ANGLE,payload:e})]})})}},appClearAngles=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_CLEAR_ANGLES,payload:e})]})})}},appSetDisplayMode=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_DISPLAY_MODE,payload:e})]})})}},appSetGraphEnabled=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_NODES_ENABLED,payload:e})]})})}},appSetBoundingBoxEnabled=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_BOUNDINGBOX_VISIBLE,payload:e})]})})}},appSetOrientation=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_ORIENTATION,payload:e})]})})}},appSetSlicesIndex=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_SLICES_INDEX,payload:e})]})})}},appSetSlicesWindowWidth=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_SLICES_WINDOW_WIDTH,payload:e})]})})}},appSetSlicesWindowCenter=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_SLICES_WINDOW_CENTER,payload:e})]})})}},appSetVolumeSteps=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_VOLUME_STEPS,payload:e})]})})}},appSetVolumeWindowWidth=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_VOLUME_WINDOW_WIDTH,payload:e})]})})}},appSetVolumeWindowCenter=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_VOLUME_WINDOW_CENTER,payload:e})]})})}},appSetCamera=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_CAMERA,payload:e})]})})}},appSetControlsEnabled=function(e){return function(t,n){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(n){return[2,t({type:TypeKeys.APP_SET_CONTROLS_ENABLED,payload:e})]})})}};function symbolObservablePonyfill(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}var result=symbolObservablePonyfill(root="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),randomString=function(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function isPlainObject(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function createStore(e,t,n){var i;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(createStore)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var r=e,s=t,o=[],a=o,l=!1;function d(){a===o&&(a=o.slice())}function c(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return s}function h(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return d(),a.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,d();var n=a.indexOf(e);a.splice(n,1)}}}function u(e){if(!isPlainObject(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,s=r(s,e)}finally{l=!1}for(var t=o=a,n=0;n<t.length;n++)(0,t[n])();return e}return u({type:ActionTypes.INIT}),(i={dispatch:u,subscribe:h,getState:c,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");r=e,u({type:ActionTypes.REPLACE})}})[result]=function(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(c())}return n(),{unsubscribe:t(n)}}})[result]=function(){return this},e},i}function getUndefinedStateErrorMessage(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function assertReducerShape(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:ActionTypes.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:ActionTypes.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}function combineReducers(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var r=t[i];"function"==typeof e[r]&&(n[r]=e[r])}var s,o=Object.keys(n);try{assertReducerShape(n)}catch(e){s=e}return function(e,t){if(void 0===e&&(e={}),s)throw s;for(var i=!1,r={},a=0;a<o.length;a++){var l=o[a],d=e[l],c=(0,n[l])(d,t);if(void 0===c){var h=getUndefinedStateErrorMessage(l,t);throw new Error(h)}r[l]=c,i=i||c!==d}return i?r:e}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){_defineProperty(e,t,n[t])})}return e}function compose(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function applyMiddleware(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),i=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},r={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},s=t.map(function(e){return e(r)});return _objectSpread({},n,{dispatch:i=compose.apply(void 0,s)(n.dispatch)})}}}function createThunkMiddleware(e){return function(t){var n=t.dispatch,i=t.getState;return function(t){return function(r){return"function"==typeof r?r(n,i,e):t(r)}}}}var thunk=createThunkMiddleware();thunk.withExtraArgument=createThunkMiddleware;var getInitialState=function(){return{angles:new Map,boundingBoxEnabled:!1,camera:null,controlsEnabled:!0,displayMode:DisplayMode.MESH,edges:new Map,nodes:new Map,graphEnabled:!1,orientation:Orientation.CORONAL,selected:null,slicesIndex:0,slicesWindowCenter:0,slicesWindowWidth:0,src:null,srcLoaded:!1,volumeSteps:16,volumeWindowCenter:0,volumeWindowWidth:0}},app=function(e,t){switch(void 0===e&&(e=getInitialState()),t.type){case TypeKeys.APP_SET_SRC:var n=t.payload,i=n[0],r=n[1],s=void 0;if(r)s=r;else if(i){var o=GetUtils$$1.getFileExtension(i);s=Object.values(MeshFileType).includes(o)?DisplayMode.MESH:DisplayMode.SLICES}else s=DisplayMode.MESH;return Object.assign({},e,{angles:new Map,controlsEnabled:!1,displayMode:s,edges:new Map,nodes:new Map,orientation:Orientation.CORONAL,selected:null,slicesIndex:0,slicesWindowCenter:0,slicesWindowWidth:0,src:i,srcLoaded:!1,volumeSteps:16,volumeWindowCenter:0,volumeWindowWidth:0});case TypeKeys.APP_SET_SRC_LOADED:return Object.assign({},e,{controlsEnabled:t.payload,srcLoaded:t.payload});case TypeKeys.APP_SET_NODE:var a=t.payload,l=a[0],d=a[1],c=JSON.parse(JSON.stringify(d)),h=e.nodes.get(l),u=Object.assign({},h,c);return Object.assign({},e,{selected:h?e.selected:l,nodes:new Map(e.nodes).set(l,u)});case TypeKeys.APP_DELETE_NODE:return Object.assign({},e,{selected:e.selected===t.payload?null:e.selected,nodes:new Map(e.nodes.slice().filter(function(e){return e[0]!==t.payload})),edges:new Map(e.edges.slice().filter(function(e){var n=e[1];return t.payload!==n.node1Id&&t.payload!==n.node2Id}))});case TypeKeys.APP_SELECT_NODE:return Object.assign({},e,{selected:t.payload});case TypeKeys.APP_CLEAR_NODES:return Object.assign({},e,{nodes:new Map});case TypeKeys.APP_SET_EDGE:var p=t.payload;return l=p[0],d=p[1],c=JSON.parse(JSON.stringify(d)),h=e.edges.get(l),u=Object.assign({},h,c),Object.assign({},e,{selected:h?e.selected:l,edges:new Map(e.edges).set(l,u)});case TypeKeys.APP_DELETE_EDGE:return Object.assign({},e,{selected:e.selected===t.payload?null:e.selected,edges:new Map(e.edges.slice().filter(function(e){return e[0]!==t.payload})),angles:new Map(e.angles.slice().filter(function(e){var n=e[1];return t.payload!==n.edge1Id&&t.payload!==n.edge2Id}))});case TypeKeys.APP_SELECT_EDGE:return Object.assign({},e,{selected:t.payload});case TypeKeys.APP_CLEAR_EDGES:return Object.assign({},e,{edges:new Map});case TypeKeys.APP_SET_ANGLE:var E=t.payload;return l=E[0],d=E[1],c=JSON.parse(JSON.stringify(d)),h=e.angles.get(l),u=Object.assign({},h,c),Object.assign({},e,{selected:h?e.selected:l,angles:new Map(e.angles).set(l,u)});case TypeKeys.APP_DELETE_ANGLE:return Object.assign({},e,{selected:e.selected===t.payload?null:e.selected,angles:new Map(e.angles.slice().filter(function(e){return e[0]!==t.payload}))});case TypeKeys.APP_SELECT_ANGLE:return Object.assign({},e,{selected:t.payload});case TypeKeys.APP_CLEAR_ANGLES:return Object.assign({},e,{angles:new Map});case TypeKeys.APP_SET_DISPLAY_MODE:return Object.assign({},e,{displayMode:t.payload});case TypeKeys.APP_SET_ORIENTATION:return Object.assign({},e,{slicesIndex:void 0,orientation:t.payload});case TypeKeys.APP_SET_NODES_ENABLED:return Object.assign({},e,{graphEnabled:t.payload});case TypeKeys.APP_SET_BOUNDINGBOX_VISIBLE:return Object.assign({},e,{boundingBoxEnabled:t.payload});case TypeKeys.APP_SET_SLICES_INDEX:return Object.assign({},e,{slicesIndex:t.payload});case TypeKeys.APP_SET_SLICES_WINDOW_WIDTH:return Object.assign({},e,{slicesWindowWidth:t.payload});case TypeKeys.APP_SET_SLICES_WINDOW_CENTER:return Object.assign({},e,{slicesWindowCenter:t.payload});case TypeKeys.APP_SET_VOLUME_STEPS:return Object.assign({},e,{volumeSteps:t.payload});case TypeKeys.APP_SET_VOLUME_WINDOW_WIDTH:return Object.assign({},e,{volumeWindowWidth:t.payload});case TypeKeys.APP_SET_VOLUME_WINDOW_CENTER:return Object.assign({},e,{volumeWindowCenter:t.payload});case TypeKeys.APP_SET_CAMERA:return Object.assign({},e,{camera:Object.assign({},e.camera,t.payload)});case TypeKeys.APP_SET_CONTROLS_ENABLED:return Object.assign({},e,{controlsEnabled:t.payload})}return e},rootReducer=combineReducers({app:app}),configureStore=function(e){return createStore(rootReducer,e,applyMiddleware(thunk))},Aleph=function(){function e(){this._hovered=null,this._isShiftDown=!1,this._isWebGl2=!0,this.width="640",this.height="480"}return e.prototype.load=function(e,t){return tslib_1.__awaiter(this,void 0,void 0,function(){var n=this;return tslib_1.__generator(this,function(i){return this.src?(this._setSrc(null),setTimeout(function(){n._setSrc(e,t)},Constants.minLoadingMS)):this._setSrc(e,t),[2]})})},e.prototype.resize=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(e){return this._resize(),[2]})})},e.prototype.setNode=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setNode(e),[2]})})},e.prototype.setGraph=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setGraph(e),[2]})})},e.prototype.deleteNode=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._deleteNode(e),[2]})})},e.prototype.clearGraph=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(e){return this._clearGraph(),[2]})})},e.prototype.selectNode=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._selectNode(e,!0),[2]})})},e.prototype.deleteEdge=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._deleteEdge(e),[2]})})},e.prototype.deleteAngle=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._deleteAngle(e),[2]})})},e.prototype.setEdge=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setEdge(e),[2]})})},e.prototype.setDisplayMode=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setDisplayMode(e),[2]})})},e.prototype.setGraphEnabled=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setGraphEnabled(e),[2]})})},e.prototype.setBoundingBoxEnabled=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setBoundingBoxEnabled(e),[2]})})},e.prototype.setSlicesIndex=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setSlicesIndex(e),[2]})})},e.prototype.setOrientation=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setOrientation(e),[2]})})},e.prototype.setSlicesWindowCenter=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setSlicesWindowCenter(e),[2]})})},e.prototype.setSlicesWindowWidth=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setSlicesWindowWidth(e),[2]})})},e.prototype.setVolumeSteps=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setVolumeSteps(e),[2]})})},e.prototype.setVolumeWindowCenter=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setVolumeWindowCenter(e),[2]})})},e.prototype.setVolumeWindowWidth=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this._setVolumeWindowWidth(e),[2]})})},e.prototype.componentWillLoad=function(){this._isWebGl2=ThreeUtils.isWebGL2Available(),this.store.setStore(configureStore({})),this.store.mapStateToProps(this,function(e){var t=e.app;return{angles:t.angles,boundingBoxEnabled:t.boundingBoxEnabled,camera:t.camera,controlsEnabled:t.controlsEnabled,displayMode:t.displayMode,edges:t.edges,graphEnabled:t.graphEnabled,nodes:t.nodes,orientation:t.orientation,selected:t.selected,slicesIndex:t.slicesIndex,slicesWindowCenter:t.slicesWindowCenter,slicesWindowWidth:t.slicesWindowWidth,src:t.src,srcLoaded:t.srcLoaded,volumeSteps:t.volumeSteps,volumeWindowCenter:t.volumeWindowCenter,volumeWindowWidth:t.volumeWindowWidth}}),this.store.mapDispatchToProps(this,{appClearAngles:appClearAngles,appClearEdges:appClearEdges,appClearNodes:appClearNodes,appDeleteAngle:appDeleteAngle,appDeleteEdge:appDeleteEdge,appDeleteNode:appDeleteNode,appSelectAngle:appSelectAngle,appSelectEdge:appSelectEdge,appSelectNode:appSelectNode,appSetAngle:appSetAngle,appSetBoundingBoxEnabled:appSetBoundingBoxEnabled,appSetCamera:appSetCamera,appSetControlsEnabled:appSetControlsEnabled,appSetDisplayMode:appSetDisplayMode,appSetEdge:appSetEdge,appSetGraphEnabled:appSetGraphEnabled,appSetNode:appSetNode,appSetOrientation:appSetOrientation,appSetSlicesIndex:appSetSlicesIndex,appSetSlicesWindowCenter:appSetSlicesWindowCenter,appSetSlicesWindowWidth:appSetSlicesWindowWidth,appSetSrc:appSetSrc,appSetSrcLoaded:appSetSrcLoaded,appSetVolumeSteps:appSetVolumeSteps,appSetVolumeWindowCenter:appSetVolumeWindowCenter,appSetVolumeWindowWidth:appSetVolumeWindowWidth}),this._controlsAnimationFinishedHandler=this._controlsAnimationFinishedHandler.bind(this),this._controlsInteractionHandler=this._controlsInteractionHandler.bind(this),this._graphEntryDraggedHandler=this._graphEntryDraggedHandler.bind(this),this._graphEntryPointerDownHandler=this._graphEntryPointerDownHandler.bind(this),this._graphEntryPointerOutHandler=this._graphEntryPointerOutHandler.bind(this),this._graphEntryPointerOverHandler=this._graphEntryPointerOverHandler.bind(this),this._graphEntryPointerUpHandler=this._graphEntryPointerUpHandler.bind(this),this._graphEntrySelectedHandler=this._graphEntrySelectedHandler.bind(this),this._graphEntryValidTargetHandler=this._graphEntryValidTargetHandler.bind(this),this._keyDownHandler=this._keyDownHandler.bind(this),this._keyUpHandler=this._keyUpHandler.bind(this),this._controlsInteractionFinishedHandler=this._controlsInteractionFinishedHandler.bind(this),this._spawnNodeHandler=this._spawnNodeHandler.bind(this),this._srcLoaded=this._srcLoaded.bind(this),this._debouncedAppSetCamera=EventUtils.debounce(this.appSetCamera,Constants.minFrameMS).bind(this)},e.prototype._renderSpinner=function(){if(this.src&&!this.srcLoaded)return h("div",{id:"spinner"},h("div",{class:"square"}))},e.prototype._renderSrc=function(){var e=this;if(!this.src)return null;switch(this.displayMode){case DisplayMode.MESH:return h("a-entity",{class:"collidable","al-node-spawner":"\n              graphEnabled: "+this.graphEnabled+";\n            ","al-gltf-model":"\n              src: url("+this.src+");\n              dracoDecoderPath: "+this.dracoDecoderPath+";\n            ",position:"0 0 0",scale:"1 1 1",ref:function(t){return e._targetEntity=t}});case DisplayMode.SLICES:return h("a-entity",{id:"target-entity",class:"collidable","al-node-spawner":"\n              graphEnabled: "+this.graphEnabled+";\n            ","al-volume":"\n              srcLoaded: "+this.srcLoaded+";\n              src: "+this.src+";\n              displayMode: "+this.displayMode+";\n              slicesIndex: "+this.slicesIndex+";\n              slicesOrientation: "+this.orientation+";\n              slicesWindowWidth: "+this.slicesWindowWidth+";\n              slicesWindowCenter: "+this.slicesWindowCenter+";\n              volumeSteps: "+this.volumeSteps+";\n              volumeWindowCenter: "+this.volumeWindowCenter+";\n              volumeWindowWidth: "+this.volumeWindowWidth+";\n              isWebGl2: "+this._isWebGl2+";\n            ",position:"0 0 0",ref:function(t){return e._targetEntity=t}});case DisplayMode.VOLUME:return h("a-entity",{id:"target-entity","al-volume":"\n              srcLoaded: "+this.srcLoaded+";\n              src: "+this.src+";\n              displayMode: "+this.displayMode+";\n              slicesIndex: "+this.slicesIndex+";\n              slicesOrientation: "+this.orientation+";\n              slicesWindowWidth: "+this.slicesWindowWidth+";\n              slicesWindowCenter: "+this.slicesWindowCenter+";\n              volumeSteps: "+this.volumeSteps+";\n              volumeWindowCenter: "+this.volumeWindowCenter+";\n              volumeWindowWidth: "+this.volumeWindowWidth+";\n              isWebGl2: "+this._isWebGl2+";\n            ",position:"0 0 0",ref:function(t){return e._targetEntity=t}})}},e.prototype._renderBoundingBox=function(){var e=this;if(this.srcLoaded&&this.boundingBoxEnabled){var t=new THREE.Vector3;this._boundingBox.getSize(t);var n=void 0;switch(this.displayMode){case DisplayMode.MESH:n=this._targetEntity.object3D.position.clone();break;case DisplayMode.VOLUME:case DisplayMode.SLICES:n=this._targetEntity.object3D.position.clone().add(GetUtils$$1.getGeometryCenter(this._getMesh().geometry))}return h("a-entity",this.displayMode===DisplayMode.VOLUME?{position:ThreeUtils.vector3ToString(n),"al-bounding-box":"\n              scale: "+ThreeUtils.vector3ToString(t)+";\n              color: "+Constants.colorValues.red+";\n            ","al-node-spawner":"\n              graphEnabled: "+this.graphEnabled+";\n            ",class:"collidable",ref:function(t){return e._boundingEntity=t}}:{position:ThreeUtils.vector3ToString(n),"al-bounding-box":"\n              scale: "+ThreeUtils.vector3ToString(t)+";\n              color: "+Constants.colorValues.red+";\n            ",ref:function(t){return e._boundingEntity=t}})}return null},e.prototype._renderNodes=function(){var e=this;return Array.from(this.nodes).map(function(t){var n=t[0],i=t[1],r=new THREE.Vector3(0,2.5,0);return r.multiplyScalar(i.scale),h("a-entity",{class:"collidable",id:n,position:i.position,"al-node":"\n            scale: "+i.scale+";\n            selected: "+(e.selected===n)+";\n            graphEnabled: "+e.graphEnabled+";\n          "},h("a-entity",{text:"\n              value: "+i.title+";\n              side: double;\n              align: center;\n              baseline: bottom;\n              anchor: center;\n              width: "+Constants.fontSizeMedium*e._boundingSphereRadius+"\n            ","al-look-to-camera":!0,"al-render-overlaid":!0,visible:""+(e.selected===n),position:ThreeUtils.vector3ToString(r),id:n+"-label"}))})},e.prototype._renderEdges=function(){var e=this;return Array.from(this.edges).map(function(t){var n=t[0],i=t[1],r=e.nodes.get(i.node1Id),s=e.nodes.get(i.node2Id);if(r&&s){var o=ThreeUtils.stringToVector3(r.position),a=ThreeUtils.stringToVector3(s.position).clone().sub(o),l=a.length();a=a.normalize().multiplyScalar(.5*l);var d=o.clone().add(a),c=new THREE.Vector3(0,2.5,0),u=(r.scale+s.scale)/2,p=e._boundingSphereRadius*Constants.edgeSize;return c.multiplyScalar(u),h("a-entity",{class:"collidable",id:n,position:ThreeUtils.vector3ToString(d),"al-edge":"\n              length: "+l+";\n              node1: "+r.position+";\n              node2: "+s.position+";\n              selected: "+(e.selected===n)+";\n              radius: "+p+";\n              nodeScale: "+u+";\n            "},h("a-entity",{id:n+"-title",text:"\n                value: "+l.toFixed(Constants.angleUnitsDecimalPlaces)+(e.displayMode===DisplayMode.MESH?"m":"mm")+";\n                side: double;\n                align: center;\n                baseline: bottom;\n                anchor: center;\n                width: "+Constants.fontSizeSmall*e._boundingSphereRadius+"\n              ",position:ThreeUtils.vector3ToString(c),visible:""+(e.selected===n),"al-look-to-camera":!0,"al-render-overlaid":!0}))}})},e.prototype._renderAngles=function(){var e=this;return Array.from(this.angles).map(function(t){var n=t[0],i=t[1],r=e.edges.get(i.edge1Id),s=e.edges.get(i.edge2Id);if(r&&s){var o=e._boundingSphereRadius*Constants.edgeSize,a=void 0,l=void 0,d=void 0;r.node1Id===s.node1Id?(a=e.nodes.get(s.node1Id),l=e.nodes.get(r.node2Id),d=e.nodes.get(s.node2Id)):r.node1Id===s.node2Id?(a=e.nodes.get(s.node2Id),l=e.nodes.get(r.node2Id),d=e.nodes.get(s.node1Id)):r.node2Id===s.node1Id?(a=e.nodes.get(s.node1Id),l=e.nodes.get(r.node1Id),d=e.nodes.get(s.node2Id)):r.node2Id===s.node2Id&&(a=e.nodes.get(s.node2Id),l=e.nodes.get(r.node1Id),d=e.nodes.get(s.node1Id));var c=ThreeUtils.stringToVector3(l.position),u=ThreeUtils.stringToVector3(d.position),p=ThreeUtils.stringToVector3(a.position),E=c.clone().sub(p).normalize(),f=u.clone().sub(p).normalize(),_=f.angleTo(E),m=Math.min(p.distanceTo(c),p.distanceTo(u)),v=Math.min(.25*m,25*o);v=Math.max(v,10*o);var g=E.clone().multiplyScalar(v),y=f.clone().multiplyScalar(v),b=g.clone().distanceTo(y.clone()),S=g.clone().add(y.clone()).divideScalar(2),T=new THREE.Vector3(0,2.5,0);return T.multiplyScalar((l.scale+d.scale+a.scale)/3),h("a-entity",{class:"collidable",id:n,position:a.position,"al-angle":"\n              selected: "+(e.selected===n)+";\n              edge0Pos: "+ThreeUtils.vector3ToString(g)+";\n              edge1Pos: "+ThreeUtils.vector3ToString(y)+";\n              position: "+ThreeUtils.vector3ToString(S)+";\n              length: "+b+";\n              radius: "+o+";\n              angle: "+_+";\n            "},h("a-entity",{id:n+"-title",text:"\n                value: "+THREE.Math.radToDeg(_).toFixed(Constants.angleUnitsDecimalPlaces)+" deg;\n                side: double;\n                align: center;\n                baseline: bottom;\n                anchor: center;\n                width: "+Constants.fontSizeSmall*e._boundingSphereRadius+"\n              ",position:ThreeUtils.vector3ToString(S.clone().add(T)),visible:""+(e.selected===n),"al-look-to-camera":!0,"al-render-overlaid":!0}))}})},e.prototype._renderLights=function(){return[h("a-entity",{id:"light-1",light:"type: directional; color: #ffffff; intensity: 0.75",position:"1 1 1"}),h("a-entity",{id:"light-2",light:"type: directional; color: #002958; intensity: 0.5",position:"-1 -1 -1"}),h("a-entity",{id:"light-3",light:"type: ambient; color: #d0d0d0; intensity: 1"})]},e.prototype._renderCamera=function(){var e=this;return h("a-camera",{fov:Constants.cameraValues.fov,near:Constants.cameraValues.near,"look-controls":"enabled: false",far:Constants.cameraValues.far,id:"mainCamera",cursor:"rayOrigin: mouse",raycaster:"objects: .collidable;","al-orbit-control":"\n          maxPolarAngle: "+Constants.cameraValues.maxPolarAngle+";\n          minDistance: "+Constants.cameraValues.minDistance+";\n          screenSpacePanning: true;\n          rotateSpeed: "+Constants.cameraValues.rotateSpeed+";\n          zoomSpeed: "+Constants.cameraValues.zoomSpeed+";\n          enableDamping: true;\n          dampingFactor: "+Constants.cameraValues.dampingFactor+";\n          controlTarget: "+ThreeUtils.vector3ToString(this.camera?this.camera.target:new THREE.Vector3(0,0,0))+";\n          controlPosition: "+ThreeUtils.vector3ToString(this.camera?this.camera.position:new THREE.Vector3(0,0,0))+";\n          enabled: "+this.controlsEnabled+";\n          animating: "+(!(!this.camera||!this.camera.animating)&&this.camera.animating)+"\n        ",ref:function(t){return e._camera=t}})},e.prototype._renderScene=function(){var e=this;return h("a-scene",{embedded:!0,renderer:"\n          colorManagement: true;\n          sortObjects: true;\n          webgl2: "+this._isWebGl2+";\n          antialias: true;\n        ","vr-mode-ui":"enabled: false",ref:function(t){return e._scene=t}},this._renderBoundingBox(),this._renderSrc(),this._renderNodes(),this._renderEdges(),this._renderAngles(),this._renderLights(),this._renderCamera())},e.prototype.render=function(){return h("div",{id:"al-container",style:{width:GetUtils$$1.addCssUnits(this.width),height:GetUtils$$1.addCssUnits(this.height)}},h("div",{id:"lut-container"},h("div",{id:"lut-min"},"0.0"),h("div",{id:"lut-canvases"}),h("div",{id:"lut-max"},"1.0")),this._renderScene(),this._renderSpinner())},e.prototype._resize=function(){this._scene&&this._scene.resize()},e.prototype._createEdge=function(e,t){if(Array.from(this.edges).find(function(n){var i=n[1];return i.node1Id===e&&i.node2Id===t||i.node1Id===t&&i.node2Id===e}))console.log("edge already exists");else{var n={node1Id:e,node2Id:t},i=GraphUtils.getNextId(AlGraphEntryType.EDGE,this.edges);this._setEdge([i,n])}},e.prototype._createAngle=function(e,t){if(Array.from(this.angles).find(function(n){var i=n[1];return i.edge1Id===e&&i.edge2Id===t||i.edge1Id===t&&i.edge2Id===e}))console.warn("cannot create angle: angle already exists");else{var n=this.edges.get(e),i=this.edges.get(t);if(n.node1Id===i.node1Id||n.node1Id==i.node2Id||n.node2Id==i.node1Id||n.node2Id===i.node2Id){var r={edge1Id:e,edge2Id:t},s=GraphUtils.getNextId(AlGraphEntryType.ANGLE,this.angles);this._setAngle([s,r])}else console.warn("cannot create angle: edges not connected")}},e.prototype._stateChanged=function(){this.changed.emit(this.store.getState().app)},e.prototype._setGraph=function(e){var t=this;e.nodes&&new Map(e.nodes).forEach(function(e,n){t.appSetNode([n,e])}),e.edges&&new Map(e.edges).forEach(function(e,n){t.appSetEdge([n,e])}),e.angles&&new Map(e.angles).forEach(function(e,n){t.appSetAngle([n,e])}),this._stateChanged()},e.prototype._clearGraph=function(){this.appClearNodes(),this.appClearEdges(),this.appClearAngles(),this._stateChanged()},e.prototype._deleteNode=function(e){this.appDeleteNode(e),this._stateChanged()},e.prototype._setNode=function(e){this.appSetNode(e),this._stateChanged()},e.prototype._selectNode=function(e,t){if(void 0===t&&(t=!1),t&&e!==this.selected){var n={position:this.camera.position.clone(),target:this.camera.target.clone()},i={position:new THREE.Vector3(-1,-1,-1),target:this.camera.target.clone()},r=GetUtils$$1.getCameraPositionFromNode(this.nodes.get(e),this._boundingSphereRadius,this.camera.target);if(r){var s=r.distanceTo(this.camera.position);if(s>0){i.position.copy(r.clone());var o=ThreeUtils.getSlerpPath(n,i,s>0,!1);this._scene.emit(AlOrbitControlEvents.ANIMATION_STARTED,{slerpPath:o},!1),this.appSetCamera({animating:!0}),this.appSelectNode(e),this._stateChanged()}}}else this.appSelectNode(e),this._stateChanged()},e.prototype._setEdge=function(e){this.appSetEdge(e),this._stateChanged()},e.prototype._deleteEdge=function(e){this.appDeleteEdge(e),this._stateChanged()},e.prototype._selectEdge=function(e){this.appSelectEdge(e),this._stateChanged()},e.prototype._setAngle=function(e){this.appSetAngle(e),this._stateChanged()},e.prototype._selectAngle=function(e){this.appSelectAngle(e),this._stateChanged()},e.prototype._deleteAngle=function(e){this.appDeleteAngle(e),this._stateChanged()},e.prototype._setGraphEnabled=function(e){this.appSetGraphEnabled(e),this._stateChanged()},e.prototype._setBoundingBoxEnabled=function(e){this.appSetBoundingBoxEnabled(e),this._stateChanged()},e.prototype._setSlicesIndex=function(e){this.appSetSlicesIndex(e),this._stateChanged()},e.prototype._setOrientation=function(e){this.appSetOrientation(e),this._stateChanged()},e.prototype._setSlicesWindowCenter=function(e){this.appSetSlicesWindowCenter(e),this._stateChanged()},e.prototype._setSlicesWindowWidth=function(e){this.appSetSlicesWindowWidth(e),this._stateChanged()},e.prototype._setVolumeSteps=function(e){this.appSetVolumeSteps(e),this._stateChanged()},e.prototype._setVolumeWindowCenter=function(e){this.appSetVolumeWindowCenter(e),this._stateChanged()},e.prototype._setVolumeWindowWidth=function(e){this.appSetVolumeWindowWidth(e),this._stateChanged()},e.prototype._setDisplayMode=function(e){this.appSetDisplayMode(e),this._stateChanged()},e.prototype._setSrc=function(e,t){this.appSetSrc([e,t]),this._stateChanged()},e.prototype._getStackHelper=function(){var e=null;return this.displayMode===DisplayMode.VOLUME&&(e=this._loadedObject),e},e.prototype._getMesh=function(){var e=null;if(this.displayMode==DisplayMode.MESH){var t=this._targetEntity.object3DMap.mesh;t instanceof THREE.Mesh?e=t:t.traverse(function(t){t instanceof THREE.Mesh&&null===e&&(e=t)})}else e=this._loadedObject._bBox?this._loadedObject._bBox._mesh:this._loadedObject._mesh;return e},e.prototype._srcLoaded=function(e){this._loadedObject=e.detail;var t=this._getMesh();if(!t)throw new Error("Unable to find a mesh in loaded object");t.geometry.computeBoundingSphere(),this._boundingSphereRadius=t.geometry.boundingSphere.radius,this._boundingBox=GetUtils$$1.getBoundingBox(t);var n=GetUtils$$1.getCameraStateFromMesh(t);n&&this.appSetCamera(n),this.appSetSrcLoaded(!0),this._stateChanged(),this.loaded.emit(e.detail)},e.prototype._keyDownHandler=function(e){this._isShiftDown=e.shiftKey,e.keyCode===KeyDown.Delete&&this.selected&&(this.nodes.has(this.selected)?this._deleteNode(this.selected):this.edges.has(this.selected)?this._deleteEdge(this.selected):this.angles.has(this.selected)&&this._deleteAngle(this.selected))},e.prototype._keyUpHandler=function(e){this._isShiftDown=!1},e.prototype._graphEntryPointerUpHandler=function(e){this.appSetControlsEnabled(!0),ThreeUtils.enableOrbitControls(this._camera,!0)},e.prototype._graphEntryPointerDownHandler=function(e){this.appSetControlsEnabled(!1),ThreeUtils.enableOrbitControls(this._camera,!1)},e.prototype._graphEntryPointerOutHandler=function(e){this._hovered=null},e.prototype._graphEntryPointerOverHandler=function(e){this._hovered=e.detail.id},e.prototype._controlsInteractionHandler=function(e){},e.prototype._controlsInteractionFinishedHandler=function(e){this._debouncedAppSetCamera(e.detail.cameraState)},e.prototype._spawnNodeHandler=function(e){if(this.graphEnabled&&this._validTarget&&null===this._hovered){var t=e.detail.aframeEvent.detail.intersection,n=GraphUtils.getNextId(AlGraphEntryType.NODE,this.nodes),i=void 0;if(this.displayMode===DisplayMode.VOLUME&&t){var r=new THREE.Vector3,s=new THREE.Vector3;AMIUtils.volumeRay(this._getStackHelper(),this._camera.object3D.children[0].position.clone(),this._camera.getAttribute("raycaster").direction,Constants.cameraValues.far,r,s)&&(i={position:ThreeUtils.vector3ToString(r),scale:this._boundingSphereRadius/Constants.nodeSizeRatio,title:n})}else t&&(i={targetId:"0",position:ThreeUtils.vector3ToString(t.point),scale:this._boundingSphereRadius/Constants.nodeSizeRatio,title:n});if(i){var o=this.selected;this._setNode([n,i]),this._isShiftDown&&this.nodes.has(o)&&(this._createEdge(o,n),this._selectNode(n))}}},e.prototype._graphEntryValidTargetHandler=function(e){this._validTarget=e.detail.valid},e.prototype._controlsAnimationFinishedHandler=function(e){this.appSetCamera({animating:!1})},e.prototype._graphEntrySelectedHandler=function(e){if(this.graphEnabled){var t=e.detail.id;switch(e.detail.type){case AlGraphEntryType.NODE:null!==this._hovered&&this.nodes.has(this._hovered)&&null!==this.selected&&this.nodes.has(this.selected)&&this.selected!==this._hovered&&this._isShiftDown&&this._createEdge(this.selected,this._hovered),this._selectNode(t);break;case AlGraphEntryType.EDGE:null!==this._hovered&&this.edges.has(this._hovered)&&null!==this.selected&&this.edges.has(this.selected)&&this.selected!==this._hovered&&this._isShiftDown&&this._createAngle(this.selected,this._hovered),this._selectEdge(t);break;case AlGraphEntryType.ANGLE:this._selectAngle(t)}}},e.prototype._graphEntryDraggedHandler=function(e){var t,n=e.detail.id,i=this._camera.components.raycaster,r=this._camera.getAttribute("raycaster"),s=new THREE.Vector3,o=!1,a=this._camera.object3D.children[0].position;if(this.displayMode===DisplayMode.VOLUME){if(t=i.getIntersection(this._boundingEntity)){var l=new THREE.Vector3;AMIUtils.volumeRay(this._getStackHelper(),a.clone(),r.direction,Constants.cameraValues.far,s,l)&&(o=!0)}}else(t=i.getIntersection(this._targetEntity))&&(s.copy(t.point),o=!0);if(!o){var d=a.distanceTo(this._targetEntity.getAttribute("position"));s.copy(a),s.add(r.direction.clone().multiplyScalar(1.5*d))}this._setNode([n,{position:ThreeUtils.vector3ToString(s)}]),this._scene.emit(n+Constants.movedEventName,{},!0)},e.prototype._addEventListeners=function(){window.addEventListener("keydown",this._keyDownHandler,!1),window.addEventListener("keyup",this._keyUpHandler,!1),this._scene.addEventListener(AlOrbitControlEvents.ANIMATION_FINISHED,this._controlsAnimationFinishedHandler,!1),this._scene.addEventListener(AlOrbitControlEvents.INTERACTION,this._controlsInteractionHandler,!1),this._scene.addEventListener(AlOrbitControlEvents.INTERACTION_FINISHED,this._controlsInteractionFinishedHandler,!1),this._scene.addEventListener(AlGraphEvents.POINTER_UP,this._graphEntryPointerUpHandler,!1),this._scene.addEventListener(AlGraphEvents.POINTER_DOWN,this._graphEntryPointerDownHandler,!1),this._scene.addEventListener(AlGraphEvents.DRAGGED,this._graphEntryDraggedHandler,!1),this._scene.addEventListener(AlGraphEvents.SELECTED,this._graphEntrySelectedHandler,!1),this._scene.addEventListener(AlNodeSpawnerEvents.ADD_NODE,this._spawnNodeHandler,!1),this._scene.addEventListener(AlNodeSpawnerEvents.VALID_TARGET,this._graphEntryValidTargetHandler,!1),this._scene.addEventListener(AlGltfModelEvents.LOADED,this._srcLoaded,!1),this._scene.addEventListener(AlVolumeEvents.LOADED,this._srcLoaded,!1),this._scene.addEventListener(AlGraphEvents.POINTER_OVER,this._graphEntryPointerOverHandler,!1),this._scene.addEventListener(AlGraphEvents.POINTER_OUT,this._graphEntryPointerOutHandler,!1)},e.prototype.componentDidLoad=function(){},e.prototype.componentDidUpdate=function(){this._scene&&this._addEventListeners()},Object.defineProperty(e,"is",{get:function(){return"uv-aleph"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{angles:{state:!0},boundingBoxEnabled:{state:!0},camera:{state:!0},clearGraph:{method:!0},controlsEnabled:{state:!0},deleteAngle:{method:!0},deleteEdge:{method:!0},deleteNode:{method:!0},displayMode:{state:!0},dracoDecoderPath:{type:String,attr:"draco-decoder-path"},edges:{state:!0},graphEnabled:{state:!0},height:{type:String,attr:"height"},load:{method:!0},nodes:{state:!0},nodesVisible:{state:!0},optionsEnabled:{state:!0},optionsVisible:{state:!0},orientation:{state:!0},resize:{method:!0},selected:{state:!0},selectNode:{method:!0},setBoundingBoxEnabled:{method:!0},setDisplayMode:{method:!0},setEdge:{method:!0},setGraph:{method:!0},setGraphEnabled:{method:!0},setNode:{method:!0},setOrientation:{method:!0},setSlicesIndex:{method:!0},setSlicesWindowCenter:{method:!0},setSlicesWindowWidth:{method:!0},setVolumeSteps:{method:!0},setVolumeWindowCenter:{method:!0},setVolumeWindowWidth:{method:!0},slicesIndex:{state:!0},slicesWindowCenter:{state:!0},slicesWindowWidth:{state:!0},src:{state:!0},srcLoaded:{state:!0},store:{context:"store"},volumeSteps:{state:!0},volumeWindowCenter:{state:!0},volumeWindowWidth:{state:!0},width:{type:String,attr:"width"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"events",{get:function(){return[{name:"changed",method:"changed",bubbles:!0,cancelable:!0,composed:!0},{name:"loaded",method:"loaded",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"#al-container{position:relative;font-family:sans-serif}#al-container a-scene{background-color:var(--viewport-background-color);display:block;width:100%;height:100%}#al-container #lut-container{display:none}#al-container .progress.container{position:absolute;top:auto!important;bottom:0!important}#al-container .progress.container .load.progress,#al-container .progress.container .parse.progress{border:none!important;height:4px!important;background-color:var(--load-progress-color,#fff)!important}#spinner{position:absolute;left:50%;top:50%}#spinner .square{margin:0 0 0 -15px;background-color:var(--spinner-color,#fff);width:30px;height:30px;-webkit-animation:sk-rotateplane 1.2s ease-in-out infinite;-moz-animation:sk-rotateplane 1.2s infinite ease-in-out;animation:sk-rotateplane 1.2s ease-in-out infinite}\@-webkit-keyframes sk-rotateplane{0%{-webkit-transform:perspective(120px)}50%{-webkit-transform:perspective(120px) rotateY(180deg)}to{-webkit-transform:perspective(120px) rotateY(180deg) rotateX(180deg)}}\@keyframes sk-rotateplane{0%{transform:perspective(120px) rotateX(0deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(0deg) rotateY(0deg)}50%{transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg)}to{transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg);-webkit-transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg)}}"},enumerable:!0,configurable:!0}),e}();export{Aleph as UvAleph};